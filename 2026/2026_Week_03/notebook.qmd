---
title: "Astronomy Picture of the Day (APOD) Archive"
subtitle: "TidyTuesday Week 03"
author: "Aghata Charnobay"
date: "2026-01-20"
categories: [text mining, wordcloud]
page-navigation: true
toc: true
toc-depth: 3
format:
  html:
    theme: flatly
execute: 
  warning: false
  message: false
---

## A look at this week's dataset

This week we're exploring the Astronomy Picture of the Day (APOD) archive. APOD is a popular NASA website featuring daily astronomy related images with a scientific explanation.

Each day a different image or photograph of our universe is featured, along with a brief explanation. This APOD archive contains image information from the 2007 - 2025, pulled together into the {astropic} R package. Thank you to Erin Grand for curating this week's dataset.

## 1 Setup

### 1.1 Load libraries

```{r}
#| label: libraries

library(tidytuesdayR)
library(tidyverse)
library(tidytext)
library(ggtext)       
library(showtext) 
library(ggbranding)
library(ggwordcloud)

```

### 1.2 Set theme

```{r}
#| label: Theme and appearance

# Font setup 

font_add_google("Commissioner")
showtext_auto()
showtext_opts(dpi = 300)


```

### 1.3 Load tidytuesday data

```{r}
#| label: load tidytuesday data

tuesdata <- tidytuesdayR::tt_load(2026, week = 3)
apod <- tuesdata$apod

```

## 2 Exploratory data analysis

### 2.1 What are the most frequent words in APOD image and video titles?

```{r}
#| label: EDA 1

word_counts = apod |>
  unnest_tokens("word", title) |>
  anti_join(stop_words, by = "word") |>
  count(word) |>
  filter(n > 80) 

word_counts |>
  arrange(desc(n))

```

**Nebula**, **NGC**, and **Galaxy** are the three most frequent words in the APOD image and video archives.

## 3 Prepare data for plotting

```{r}
#| label: Prepare data for plotting

# Create the word color pallete

my_palette = c(
  "#F8F9FA",  
  "#FFD60A",  
  "#4CC9F0",  
  "#4361EE", 
  "#B5179E"   
)

```

## 4 Plot

```{r}
#| label: Plot data

set.seed(42)

gg_wordcloud <- ggplot(
  word_counts,
  aes(
    label = word,   
    size  = n,      
    color = n       
  )
) +
  # Draw the word cloud within a defined area
  geom_text_wordcloud_area(
    eccentricity = 0.75,  # Controls the overall shape of the cloud
    rm_outside   = TRUE,  # Remove words that would fall outside the area
    fontface     = "bold"
  ) +
  # Scale word sizes proportionally to frequency
  scale_size_area(max_size = 30) +
  # Color scale using a custom palette with log transformation
  scale_color_gradientn(
    colors = my_palette,
    guide  = "none"       # Hide legend
  ) +
  # Title and subtitle
  labs(
    title    = "Text Mining the Album of the Universe",
    subtitle = "Most frequent words in NASA Astronomy Picture of the Day (APOD) titles."
  ) +
  # Base theme
  theme_minimal() +
  # Theme customization
  theme(
    plot.title.position = "panel",
    plot.title = element_text(
      face   = "bold",
      size   = 18,
      color  = "white",
      family = "Commissioner"
    ),
    plot.subtitle = element_text(
      size   = 11,
      color  = "white",
      margin = margin(t = 3, b = 25),
      family = "Commissioner"
    ),
    plot.margin = margin(t = 20, r = 20, b = 10, l = 20),
    plot.background  = element_rect(fill = "#0B1C2D", color = NA),
    panel.background = element_rect(fill = "#0B1C2D", color = NA)
  ) +
  # Branding and credits
  add_branding(
    github                = "a-charnobay",
    linkedin              = "Aghata Charnobay",
    additional_text       = "Data: NASA APOD Archive | #TidyTuesday 2026 - Week 3",
    text_position         = "before",
    line_spacing          = 1L,
    icon_color            = "#B5179E",
    text_color            = "white",
    text_family           = "Commissioner",
    caption_halign        = 1,
    icon_size             = "10pt",
    text_size             = "10pt",
    additional_text_color = "white",
    caption_margin        = margin(t = 25, b = 5, unit = "pt")
  )

gg_wordcloud
```

## 5 Save plot

```{r}
#| label: Save plot

ggsave(
  filename = "apod_nasa.png", 
  plot = gg_wordcloud,
  width = 7, 
  height = 4.6,
  dpi = 300,
  bg = "#0B1C2D"
)
```
