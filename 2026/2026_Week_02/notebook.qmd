---
title: "The Languages of Africa"
subtitle: "TidyTuesday Week 02"
author: "Aghata Charnobay"
date: "2026-01-15"
categories: [barplot, geodata, ggflags]
page-navigation: true
toc: true
toc-depth: 3
format:
  html:
    theme: flatly
execute: 
  warning: false
  message: false
---

## A look at this week's dataset

This week we're exploring data about popular languages spoken on the African continent. The dataset this week comes from the [Languages of Africa](https://en.wikipedia.org/wiki/Languages_of_Africa) page on Wikipedia.

> The number of languages natively spoken in Africa is variously estimated (depending on the delineation of language vs. dialect) at between 1,250 and 2,100 and by some counts at over 3,000.

The dataset is rich with information on the number of languages spoken across the continent. Thank you to Robert Muwanga, Data Enthusiast for curating this week's dataset.

## 1 Setup

### 1.1 Load libraries

```{r}
#| label: libraries

library(tidytuesdayR)
library(tidyverse)
library(ggtext)       
library(showtext) 
library(ggbranding)
library(countrycode) 
library(ggflags)

```

### 1.2 Set theme

```{r}
#| label: Theme and appearance

# Font setup 
font_add_google("Inter")
showtext_auto()
showtext_opts(dpi = 300)


```

### 1.3 Load tidytuesday data

```{r}
#| label: load tidytuesday data

tuesdata <- tidytuesdayR::tt_load(2026, week = 2)
languages <- tuesdata$africa

```

## 2 Exploratory data analysis

### 2.1 Which country in Africa has the largest number of spoken languages?

```{r}
languages |>
  count(country, language) |>
  filter(n > 1)
```

The same languageâ€“country pair appears more than once in the dataset.


```{r}
#| label: EDA 1

languages |>
  distinct(country, language) |>  # avoid double-counting 
  count(country, name = "n_languages") |>
  arrange(desc(n_languages)) |>
  slice_head(n = 10)
```

Cameron, Congo, and Nigeria have the largest number of spoken languages.

### 2.2 Which family of languages has the highest number of speakers?

```{r}
#| label:  EDA 2

languages |>
  distinct(language, family, native_speakers) |>
  group_by(family) |>
  summarise(
    total_speakers_millions = sum(native_speakers, na.rm = TRUE) / 1e6,
    .groups = "drop"
  ) |>
  arrange(desc(total_speakers_millions)) |>
  slice_head(n = 10)
```

Niger-Congo, Afroasiatic, and Nilo-Saharan are the language families with the highest number of speakers.


### 2.3 Are there any languages that cut across multiple countries?

```{r}
#| label: EDA 3

languages |>
  distinct(language, family, country) |>
  count(language, family, name = "n_countries") |>
  filter(n_countries > 1) |>
  arrange(desc(n_countries))

```


```{r}
#| label: EDA 3 - Plot
#| fig-width: 7
#| fig-height: 4

languages %>%
  distinct(language, country) |>
  count(language, name = "n_countries") |>
  filter(n_countries > 1) |>
  slice_max(n_countries, n = 10) |>
  ggplot(aes(
    x = reorder(language, n_countries),
    y = n_countries
  )) +
  geom_col(fill = "#2E6F40") +
  coord_flip() +
  labs(
    title = "Languages spoken across multiple African countries",
    x = NULL,
    y = "Number of countries"
  ) +
  theme_minimal()

```
Arabic, Fulani, and Soninke are the languages spoken across the highest number of nations.


## 3 Prepare data for plotting

```{r}
#| label: Prepare data for plotting

# Prepare the data for the barplot
top_diverse_countries <- languages |>
  distinct(country, language) |>
  count(country, sort = TRUE, name = "num_languages") |>
  slice_head(n = 10) |>
  mutate(
    # Convert country names to 2-letter ISO codes (lowercase for ggflags)
    code = tolower(countrycode(country, "country.name", "iso2c")),
    # Reorder country factor so the bars are sorted by count
    country = reorder(country, num_languages)
  )
```


## 4 Plot

```{r}
#| label: Plot data

p = ggplot(top_diverse_countries,
           aes(x = country,
               y = num_languages,
               fill = country)) +
  # Draw the bars
  geom_col(width = 0.85, fill = "#2E6F40") +
  # Add the flags
  geom_flag(aes(y = -5, country = code), size = 6) + 
  # Flip the coordinates for bar chart
  coord_flip() +
  # Text labels
  geom_text(
    aes(y = num_languages + 1, label = num_languages), 
    hjust = 0, # Align text to the left
    color = "grey30",
    size = 3.5
  ) +
  # Title and subtitle
  labs(
    title = "The languages of Africa",
    subtitle = "African nations with the highest number of distinct spoken languages",
    x = NULL,
    y = NULL
  ) +
  # Theme and appearance
  theme_minimal(base_family = "Inter") +
  theme(
    plot.title.position = "plot",
    plot.title = element_text(face = "bold", size = 18),
    plot.subtitle = element_text(size = 12, color = "grey30", face = "italic", margin = margin(t = 5, b = 15)),
    panel.grid = element_blank(),
    axis.text.x = element_blank(),
    axis.text.y = element_text(face = "bold", size = 11, margin = margin(r = 2)),
    plot.margin = margin(t = 30, r = 20, b = 10, l = 20),
    plot.background = element_rect(fill = "white", color = NA),
    panel.background = element_rect(fill = "white", color = NA)
  )  +
  # Branding and credits
add_branding(
  github = "a-charnobay",
  linkedin = "Aghata Charnobay",
  additional_text = "Data: Wikipedia (Languages of Africa) | #TidyTuesday 2026 - Week 2",
  text_position = "before",
  line_spacing = 2L, 
  icon_color = "#D26A44",
  text_color = "grey30",
  caption_halign = 1, 
  icon_size = "10pt", 
  text_size = "10pt",
  additional_text_color = "grey30",
  caption_margin = margin(t = 15, b = 5, unit = "pt")
)
p

```


## 5 Save plot

```{r}
#| label: Save plot

ggsave(
  filename = "languages_of_africa.png", 
  plot = p,
  width = 7, 
  height = 6,
  dpi = 300,
  bg = "white"
)
```
